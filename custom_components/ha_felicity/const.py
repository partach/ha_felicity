"""Constants for the Felicity integration."""

DOMAIN = "ha_felicity"

# Connection types
CONNECTION_TYPE_SERIAL = "serial"
CONNECTION_TYPE_TCP = "tcp"

# Common settings
CONF_SLAVE_ID = "slave_id"
CONF_CONNECTION_TYPE = "connection_type"
CONF_NAME = "name"
CONF_REGISTER_SET = "register_set"
CONF_INVERTER_MODEL = "inverter_model"

# Supported inverter models
INVERTER_MODEL_IVGM = "T-REX-10KLP3G01"  # our current one

# Serial settings
CONF_SERIAL_PORT = "serial_port"
CONF_BAUDRATE = "baudrate"
CONF_PARITY = "parity"
CONF_STOPBITS = "stopbits"
CONF_BYTESIZE = "bytesize"

# TCP settings
CONF_HOST = "host"
CONF_PORT = "port"

REGISTER_SET_BASIC = "basic"
REGISTER_SET_BASIC_PLUS = "basic_plus"
REGISTER_SET_FULL = "full"

# Defaults
DEFAULT_SLAVE_ID = 1
DEFAULT_BAUDRATE = 2400
DEFAULT_TCP_PORT = 502
DEFAULT_REGISTER_SET = "basic"
DEFAULT_STOPBITS = 1
DEFAULT_BYTESIZE = 8
DEFAULT_PARITY = "N"
DEFAULT_INVERTER_MODEL = INVERTER_MODEL_IVGM
DEFAULT_FIRST_REG = 4353

# Precision and index based on the "Rate/Magnification/Scale" column
# 0 = dont process or packed
# 1 = /10 → precision 1, index 1;
# 2 = /100 → precision 2, index 2; 
# 3 = signed index;
# 4 = energy high/low index; (obsolete)
# 5 = faults/warnings/modes/flags index; (doesnt do anything port procesing)
# 6 = time index; (obsolete)
# 7 = % index (doesnt really do anything yet)
# 8 = signed index and /10; 
# 99 -> dont show as sensor, it is a combined value, see combined registers

_REGISTERS = {
    "setting_data_sn": {"address": 4352, "name": "Setting Data Sn", "precision": 0, "index": 0},
    "working_mode": {"address": 4353, "name": "Working Mode", "precision": 0, "index": 0, "type": "select", "options": ["Power On", "Standby", "Bypass", "Off-grid", "Fault", "Line", "PV Charge"]},
    "warning_state_1": {"address": 4354, "name": "Warning State 1", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "warning_state_2": {"address": 4356, "name": "Warning State 2", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "warning_state_3": {"address": 4358, "name": "Warning State 3", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "fault_code": {"address": 4360, "name": "Fault Code", "precision": 0, "index": 0},
    "ac_input_voltage": {"address": 4361, "name": "Ac Input Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_current": {"address": 4362, "name": "Ac Input Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_frequency": {"address": 4363, "name": "Ac Input Frequency", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_input_power": {"address": 4364, "name": "Ac Input Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "battery_voltage": {"address": 4365, "name": "Battery Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "battery_current": {"address": 4366, "name": "Battery Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "battery_power": {"address": 4367, "name": "Battery Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "battery_capacity": {"address": 4368, "name": "Battery Capacity", "unit": "%", "device_class": "battery", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_voltage": {"address": 4369, "name": "Ac Output Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_current": {"address": 4370, "name": "Ac Output Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_frequency": {"address": 4371, "name": "Ac Output Frequency", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_output_active_power": {"address": 4372, "name": "Ac Output Active Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_apparent_power": {"address": 4373, "name": "Ac Output Apparent Power", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0},
    "load_percentage": {"address": 4374, "name": "Load Percentage", "unit": "%", "state_class": "measurement", "precision": 0, "index": 7},
    "pv_input_voltage": {"address": 4375, "name": "Pv Input Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "pv_input_current": {"address": 4376, "name": "Pv Input Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "pv_input_power": {"address": 4377, "name": "Pv Input Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "pv2_input_voltage": {"address": 4378, "name": "Pv2 Input Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "pv2_input_current": {"address": 4379, "name": "Pv2 Input Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "pv2_input_power": {"address": 4380, "name": "Pv2 Input Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "pv3_input_voltage": {"address": 4381, "name": "Pv3 Input Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "pv3_input_current": {"address": 4382, "name": "Pv3 Input Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "pv3_input_power": {"address": 4383, "name": "Pv3 Input Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_input_voltage_l2": {"address": 4384, "name": "Ac Input Voltage L2", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_current_l2": {"address": 4385, "name": "Ac Input Current L2", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_frequency_l2": {"address": 4386, "name": "Ac Input Frequency L2", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_input_power_l2": {"address": 4387, "name": "Ac Input Power L2", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "ac_input_voltage_l3": {"address": 4388, "name": "Ac Input Voltage L3", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_current_l3": {"address": 4389, "name": "Ac Input Current L3", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_frequency_l3": {"address": 4390, "name": "Ac Input Frequency L3", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_input_power_l3": {"address": 4391, "name": "Ac Input Power L3", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "total_ac_input_power": {"address": 4392, "name": "Total Ac Input Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3, "size": 2, "endian": "big"},
    "ac_output_voltage_l2": {"address": 4394, "name": "Ac Output Voltage L2", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_current_l2": {"address": 4395, "name": "Ac Output Current L2", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_frequency_l2": {"address": 4396, "name": "Ac Output Frequency L2", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_output_active_power_l2": {"address": 4397, "name": "Ac Output Active Power L2", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_apparent_power_l2": {"address": 4398, "name": "Ac Output Apparent Power L2", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_voltage_l3": {"address": 4399, "name": "Ac Output Voltage L3", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_current_l3": {"address": 4400, "name": "Ac Output Current L3", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_frequency_l3": {"address": 4401, "name": "Ac Output Frequency L3", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_output_active_power_l3": {"address": 4402, "name": "Ac Output Active Power L3", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_apparent_power_l3": {"address": 4403, "name": "Ac Output Apparent Power L3", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0},
    "total_ac_output_active_power": {"address": 4404, "name": "Total Ac Output Active Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "total_ac_output_apparent_power": {"address": 4406, "name": "Total Ac Output Apparent Power", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "invert_voltage": {"address": 4408, "name": "Invert Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "invert_current": {"address": 4409, "name": "Invert Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "invert_active_power": {"address": 4410, "name": "Invert Active Power", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "invert_voltage_l2": {"address": 4411, "name": "Invert Voltage L2", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "invert_current_l2": {"address": 4412, "name": "Invert Current L2", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "invert_active_power_l2": {"address": 4413, "name": "Invert Active Power L2", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "invert_voltage_l3": {"address": 4414, "name": "Invert Voltage L3", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "invert_current_l3": {"address": 4415, "name": "Invert Current L3", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "invert_active_power_l3": {"address": 4416, "name": "Invert Active Power L3", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "ac_input_mid_voltage": {"address": 4417, "name": "Ac Input Mid Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_mid_voltage_l2": {"address": 4418, "name": "Ac Input Mid Voltage L2", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_mid_voltage_l3": {"address": 4419, "name": "Ac Input Mid Voltage L3", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "p_bus_voltage_master": {"address": 4420, "name": "P Bus Voltage Master", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "n_bus_voltage_master": {"address": 4421, "name": "N Bus Voltage Master", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "p_dc_converter_voltage": {"address": 4422, "name": "P Dc Converter Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "n_dc_converter_voltage": {"address": 4423, "name": "N Dc Converter Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "p_dc_dc_current": {"address": 4424, "name": "P Dc/Dc Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "n_dc_dc_current": {"address": 4425, "name": "N Dc/Dc Current", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "inner_temperature_1": {"address": 4426, "name": "Inner Temperature 1", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "inner_temperature_2": {"address": 4427, "name": "Inner Temperature 2", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "heatsink_temperature_1": {"address": 4428, "name": "Heatsink Temperature 1", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "heatsink_temperature_2": {"address": 4429, "name": "Heatsink Temperature 2", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "heatsink_temperature_3": {"address": 4430, "name": "Heatsink Temperature 3", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "heatsink_temperature_4": {"address": 4431, "name": "Heatsink Temperature 4", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "heatsink_temperature_5": {"address": 4432, "name": "Heatsink Temperature 5", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "heatsink_temperature_6": {"address": 4433, "name": "Heatsink Temperature 6", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "time_year_month": {"address": 4434, "name": "Time Year-Month", "precision": 0, "index": 99}, 
    "time_day_hour": {"address": 4435, "name": "Time Day-Hour", "precision": 0, "index": 99},
    "time_minute_second": {"address": 4436, "name": "Time Minute-Second", "precision": 0, "index": 99},
    "time_week": {"address": 4437, "name": "Time Week", "precision": 0, "index": 99},
    "pv_generated_energy_total": {"address": 4438, "name": "Pv Generated Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "pv_generated_energy_year": {"address": 4442, "name": "Pv Generated Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "pv_generated_energy_month": {"address": 4444, "name": "Pv Generated Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "pv_generated_energy_day": {"address": 4446, "name": "Pv Generated Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "load_consumption_energy_total": {"address": 4448, "name": "Load Consumption Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "load_consumption_energy_year": {"address": 4452, "name": "Load Consumption Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "load_consumption_energy_month": {"address": 4454, "name": "Load Consumption Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "load_consumption_energy_day": {"address": 4456, "name": "Load Consumption Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "ac_input_energy_total": {"address": 4458, "name": "Ac Input Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "ac_input_energy_year": {"address": 4462, "name": "Ac Input Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "ac_input_energy_month": {"address": 4464, "name": "Ac Input Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "ac_input_energy_day": {"address": 4466, "name": "Ac Input Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "ac_generated_energy_total": {"address": 4468, "name": "Ac Generated Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "ac_generated_energy_year": {"address": 4472, "name": "Ac Generated Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "ac_generated_energy_month": {"address": 4474, "name": "Ac Generated Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "ac_generated_energy_day": {"address": 4476, "name": "Ac Generated Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "battery_charged_energy_total": {"address": 4478, "name": "Battery Charged Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "battery_charged_energy_year": {"address": 4482, "name": "Battery Charged Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "battery_charged_energy_month": {"address": 4484, "name": "Battery Charged Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "battery_charged_energy_day": {"address": 4486, "name": "Battery Charged Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "battery_discharged_energy_total": {"address": 4488, "name": "Battery Discharged Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "battery_discharged_energy_year": {"address": 4492, "name": "Battery Discharged Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "battery_discharged_energy_month": {"address": 4494, "name": "Battery Discharged Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "battery_discharged_energy_day": {"address": 4496, "name": "Battery Discharged Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "status_bit": {"address": 4498, "name": "Status Bit", "precision": 0, "index": 5},
    "p_bus_voltage_slv": {"address": 4499, "name": "P Bus Voltage_Slv", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "n_bus_voltage_slv": {"address": 4500, "name": "N Bus Voltage_Slv", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "line_power_conversion": {"address": 4501, "name": "Linepowerconversion", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 1, "size": 2, "endian": "big"},
    "load_power_conversion": {"address": 4503, "name": "Loadpowerconversion", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 1, "size": 2, "endian": "big"},
    "bat_power_conversion": {"address": 4505, "name": "Batpowerconversion", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 1},
    "pv_power_conversion": {"address": 4506, "name": "Pvpowerconversion", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "power_flow_msg": {"address": 4507, "name": "Powerflowmsg", "precision": 0, "index": 5},
    "parallel_system_state": {"address": 4508, "name": "Parallel system state", "precision": 0, "index": 5},
    "load_power_line_side": {"address": 4509, "name": "Loadpower_Lineside", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "g_uw_exist_num_parallel": {"address": 4511, "name": "G_Uwexistnum_Parallel", "precision": 0, "index": 0},
    "log_type": {"address": 4516, "name": "Log Type", "precision": 0, "index": 5},
    "log_index": {"address": 4517, "name": "Log Index", "precision": 0, "index": 0},
    "log_status": {"address": 4518, "name": "Log Status", "precision": 0, "index": 5},
    "log_id": {"address": 4519, "name": "Log Id", "precision": 0, "index": 5},
    "log_time_year_month": {"address": 4520, "name": "Log Time Year-Month", "precision": 0, "index": 99},
    "log_time_day_hour": {"address": 4521, "name": "Log Time Day-Hour", "precision": 0, "index": 99},
    "log_time_minute_second": {"address": 4522, "name": "Log Time Minute-Second", "precision": 0, "index": 99},
    "ac_input_voltage_secondary": {"address": 4523, "name": "Ac Input Voltage secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_frequency_secondary": {"address": 4524, "name": "Ac Input Frequency secondary", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_input_power_secondary": {"address": 4525, "name": "Ac Input Power secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "battery_voltage_secondary": {"address": 4526, "name": "Battery Voltage secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "battery_power_secondary": {"address": 4527, "name": "Battery Power secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "battery_capacity_secondary": {"address": 4528, "name": "Battery Capacity secondary", "unit": "%", "device_class": "battery", "state_class": "measurement", "precision": 0, "index": 1},
    "ac_output_voltage_secondary": {"address": 4529, "name": "Ac Output Voltage secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_frequency_secondary": {"address": 4530, "name": "Ac Output Frequency secondary", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_output_active_power_secondary": {"address": 4531, "name": "Ac Output Active Power  secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_apparent_power_secondary": {"address": 4532, "name": "Ac Output Apparent Power secondary", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0},
    "load_percentage_secondary": {"address": 4533, "name": "Load Percentage secondary", "unit": "%", "state_class": "measurement", "precision": 0, "index": 7},
    "pv_input_voltage_secondary": {"address": 4534, "name": "Pv Input Voltage secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "pv_input_power_secondary": {"address": 4535, "name": "Pv Input Power secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "pv2_input_voltage_secondary": {"address": 4536, "name": "Pv2 Input Voltage  secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "pv2_input_power_secondary": {"address": 4537, "name": "Pv2 Input Power secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "pv3_input_voltage_secondary": {"address": 4538, "name": "Pv3 Input Voltage secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "pv3_input_power_secondary": {"address": 4539, "name": "Pv3 Input Power  secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_input_voltage_l2_secondary": {"address": 4540, "name": "Ac Input Voltage L2 secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_frequency_l2_secondary": {"address": 4541, "name": "Ac Input Frequency L2 secondary", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_input_power_l2_secondary": {"address": 4542, "name": "Ac Input Power L2 secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "ac_input_voltage_l3_secondary": {"address": 4543, "name": "Ac Input Voltage L3 secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_input_frequency_l3_secondary": {"address": 4544, "name": "Ac Input Frequency L3 secondary", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_input_power_l3_secondary": {"address": 4545, "name": "Ac Input Power L3 secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 3},
    "ac_output_voltage_l2_secondary": {"address": 4546, "name": "Ac Output Voltage L2 secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_frequency_l2_secondary": {"address": 4547, "name": "Ac Output Frequency L2 secondary", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_output_active_power_l2_secondary": {"address": 4548, "name": "Ac Output Active Power L2 secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_apparent_power_l2_secondary": {"address": 4549, "name": "Ac Output Apparent Power L2 secondary", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_voltage_l3_secondary": {"address": 4550, "name": "Ac Output Voltage L3 secondary", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "ac_output_frequency_l3_secondary": {"address": 4551, "name": "Ac Output Frequency L3 secondary", "unit": "Hz", "device_class": "frequency", "state_class": "measurement", "precision": 2, "index": 2},
    "ac_output_active_power_l3_secondary": {"address": 4552, "name": "Ac Output Active Power L3 secondary", "unit": "W", "device_class": "power", "state_class": "measurement", "precision": 0, "index": 0},
    "ac_output_apparent_power_l3_secondary": {"address": 4553, "name": "Ac Output Apparent Power L3 secondary", "unit": "VA", "device_class": "apparent_power", "state_class": "measurement", "precision": 0, "index": 0},
    "p_bus_voltage": {"address": 4554, "name": "P Bus Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "n_bus_voltage": {"address": 4555, "name": "N Bus Voltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "p_dc_dc_current_secondary": {"address": 4556, "name": "P Dc/Dc Current  secondary", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "n_dc_dc_current_secondary": {"address": 4557, "name": "N Dc/Dc Current  secondary", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 8},
    "max_inner_temperature": {"address": 4558, "name": "Max. Inner Temperature", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "max_heat_sink_temperature": {"address": 4559, "name": "Max. Heat-Sink Temperature", "unit": "°C", "device_class": "temperature", "state_class": "measurement", "precision": 1, "index": 8},
    "CurrBMSAddr": {"address": 4606, "name": "Current BMS Address", "precision": 0, "index": 0},
    "BMS_Flg": {"address": 4607, "name": "BMS Flag", "precision": 0, "index": 0},
    "charge_voltage_limit": {"address": 4608, "name": "Chargevoltagelimit", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "discharge_voltage_limit": {"address": 4609, "name": "Dischargevoltagelimit", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 1, "index": 1},
    "charge_current_limit": {"address": 4610, "name": "Chargecurrentlimit", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "discharge_current_limit": {"address": 4611, "name": "Dischargecurrentlimit", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "bms_status_lo": {"address": 4612, "name": "Bmsstatuslo", "precision": 0, "index": 5},
    "bms_status_hi": {"address": 4613, "name": "Bmsstatushi", "precision": 0, "index": 5},
    "fault_flag_lo": {"address": 4614, "name": "Faultflaglo", "precision": 0, "index": 5},
    "fault_flag_hi": {"address": 4615, "name": "Faultflaghi", "precision": 0, "index": 5},
    "alarm_flag_lo": {"address": 4616, "name": "Alarmflaglo", "precision": 0, "index": 5},
    "alarm_flag_hi": {"address": 4617, "name": "Alarmflaghi", "precision": 0, "index": 5},
    "notice_flag_low": {"address": 4618, "name": "Noticeflaglow", "precision": 0, "index": 5},
    "notice_flag_high": {"address": 4619, "name": "Noticeflaghigh", "precision": 0, "index": 5},
    "total_current": {"address": 4620, "name": "Totalcurrent", "unit": "A", "device_class": "current", "state_class": "measurement", "precision": 1, "index": 1},
    "total_voltage": {"address": 4621, "name": "Totalvoltage", "unit": "V", "device_class": "voltage", "state_class": "measurement", "precision": 2, "index": 2},
    "total_soc": {"address": 4624, "name": "Totalsoc", "unit": "%", "device_class": "battery", "state_class": "measurement", "precision": 1, "index": 1},
    "total_soh": {"address": 4625, "name": "Totalsoh", "unit": "%", "state_class": "measurement", "precision": 1, "index": 1},
    "total_capacity_high": {"address": 4626, "name": "Totalcapacityhigh", "unit": "mAH", "precision": 0, "index": 0},
    "total_capacity_low": {"address": 4627, "name": "Totalcapacitylow", "unit": "mAH", "precision": 0, "index": 0},
    "parallel_number": {"address": 4628, "name": "Parallelnumber", "precision": 0, "index": 0},
    "parallel_status": {"address": 4629, "name": "Parallelstatus", "precision": 0, "index": 5},
    "line_load_consumption_energy_total": {"address": 4645, "name": "Lineload Consumption Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "line_load_consumption_energy_year": {"address": 4649, "name": "Lineload Consumption Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "line_load_consumption_energy_month": {"address": 4651, "name": "Lineload Consumption Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "line_load_consumption_energy_day": {"address": 4653, "name": "Lineload Consumption Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "total_load_consumption_energy_total": {"address": 4655, "name": "Totalload Consumption Energy Inquiry Total", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 4, "endian": "big"},
    "total_load_consumption_energy_year": {"address": 4659, "name": "Totalload Consumption Energy Inquiry Year", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "total_load_consumption_energy_month": {"address": 4661, "name": "Totalload Consumption Energy Inquiry Month", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
    "total_load_consumption_energy_day": {"address": 4663, "name": "Totalload Consumption Energy Inquiry Day", "unit": "Wh", "device_class": "energy", "state_class": "total_increasing", "precision": 0, "index": 0, "size": 2, "endian": "big"},
   # "Electricity meter power L1": {"address": 4864, "name": "Electricity meter power L1", "unit": "W", "device_class": "power", "precision": 0, "index": 1, "size": 2, "endian": "big"}, # not allowed registers
   # "Electricity meter power L2": {"address": 4866, "name": "Electricity meter power L2", "unit": "W", "device_class": "power", "precision": 0, "index": 1, "size": 2, "endian": "big"},
   # "Electricity meter power L3": {"address": 4868, "name": "Electricity meter power L3", "unit": "W", "device_class": "power", "precision": 0, "index": 1, "size": 2, "endian": "big"},

    "operating_mode": {"address": 8451,"name": "Operating Mode","precision": 0,"index": 0,"type": "select","options": ["General mode (self-use, load priority)","Backup mode (grid-tied, no battery discharge)","Economic mode (scheduled charge-discharge)"]},
    
    "battery_type": {"address": 8483, "name": "Battery type", "precision": 0, "index": 0, "type": "select", "options": ["User defined", "Lithium battery (default)", "FelicitySolar(LPBF series)", "FelicitySolar(LPBA series)", "No battery"]},
    "battery_pack_series_count": {"address": 8484, "name": "Battery Pack Number in Series", "precision": 0, "index": 0},  # 1~10
    "battery_charged_voltage": {"address": 8485, "name": "Battery Charged Voltage", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1},
    "battery_floating_charged_voltage": {"address": 8486, "name": "Battery Floating Charged Voltage", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1},
    "battery_cutoff_voltage_ongrid_no_bms": {"address": 8487, "name": "Battery Cut-off Voltage (On-grid, no BMS)", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1},
    "battery_cutoff_voltage_offgrid_no_bms": {"address": 8488, "name": "Battery Cut-off Voltage (Off-grid, no BMS)", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1},
    "battery_restart_voltage_offgrid_no_bms": {"address": 8489, "name": "Battery Restart Voltage (Off-grid, no BMS)", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1},
    "battery_discharge_depth_ongrid_bms": {"address": 8490, "name": "Battery Discharge Depth (On-grid, BMS)", "unit": "%", "device_class": "battery", "precision": 0, "index": 0},
    "battery_discharge_depth_offgrid_bms": {"address": 8491, "name": "Battery Discharge Depth (Off-grid, BMS)", "unit": "%", "device_class": "battery", "precision": 0, "index": 0},
    "battery_restart_depth_offgrid_bms": {"address": 8492, "name": "Battery Restart Depth (Off-grid, BMS)", "unit": "%", "device_class": "battery", "precision": 0, "index": 0},
    "battery_max_charge_current": {"address": 8493, "name": "Battery Max Charged Current", "unit": "A", "device_class": "current", "precision": 1, "index": 1},
    "battery_max_discharge_current": {"address": 8494, "name": "Battery Max Discharged Current", "unit": "A", "device_class": "current", "precision": 1, "index": 1},
    
    # Time setting (writeable)
    "time_set_year_month": {"address": 8560, "name": "Time Setting Year-Month", "precision": 0, "index": 99},
    "time_set_day_hour": {"address": 8561, "name": "Time Setting Day-Hour", "precision": 0, "index": 99},
    "time_set_minute_second": {"address": 8562, "name": "Time Setting Minute-Second", "precision": 0, "index": 99},
    "time_set_week": {"address": 8563, "name": "Time Setting Week", "precision": 0, "index": 99},
    
    # Economic Mode Rules (4 rules, each 9 registers)
    "econ_rule_1_enable": {"address": 8568, "name": "Economic Mode Rule 1 Enable", "precision": 0, "index": 0, "type": "select", "options": ["Disabled", "Charge", "Discharge"]},
    "econ_rule_1_start_time": {"address": 8569, "name": "Rule 1 Start Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_1_stop_time": {"address": 8570, "name": "Rule 1 Stop Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_1_start_day": {"address": 8571, "name": "Rule 1 Start Date", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_1_stop_day": {"address": 8572, "name": "Rule 1 Stop Date", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_1_effective_week": {"address": 8573, "name": "Rule 1 Effective Days", "precision": 0, "index": 0, "type": "select_multi", "options": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]},
    "econ_rule_1_voltage": {"address": 8574, "name": "Rule 1 Voltage", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1, "type": "number", "min": 50.0, "max": 60.0, "step": 1},
    "econ_rule_1_soc": {"address": 8575, "name": "Rule 1 SOC", "unit": "%", "device_class": "battery", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 100, "step": 1},
    "econ_rule_1_power": {"address": 8576, "name": "Rule 1 Power", "unit": "W", "device_class": "power", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 10000, "step": 100},
    
    "econ_rule_2_enable": {"address": 8577, "name": "Economic Mode Rule 2 Enable", "precision": 0, "index": 0,"type": "select", "options": ["Disabled", "Charge", "Discharge"]},
    "econ_rule_2_start_time": {"address": 8578, "name": "Rule 2 Start Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_2_stop_time": {"address": 8579, "name": "Rule 2 Stop Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_2_start_day": {"address": 8580, "name": "Rule 2 Start Day", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_2_stop_day": {"address": 8581, "name": "Rule 2 Stop Day", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_2_effective_week": {"address": 8582, "name": "Rule 2 Effective Week", "precision": 0, "index": 0, "type": "select_multi", "options": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]},
    "econ_rule_2_voltage": {"address": 8583, "name": "Rule 2 Voltage", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1, "type": "number", "min": 50.0, "max": 60.0, "step": 1},
    "econ_rule_2_soc": {"address": 8584, "name": "Rule 2 SOC", "unit": "%", "device_class": "battery", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 100, "step": 1},
    "econ_rule_2_power": {"address": 8585, "name": "Rule 2 Power", "unit": "W", "device_class": "power", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 10000, "step": 100},
    
    "econ_rule_3_enable": {"address": 8586, "name": "Economic Mode Rule 3 Enable", "precision": 0, "index": 0,"type": "select", "options": ["Disabled", "Charge", "Discharge"]},
    "econ_rule_3_start_time": {"address": 8587, "name": "Rule 3 Start Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_3_stop_time": {"address": 8588, "name": "Rule 3 Stop Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_3_start_day": {"address": 8589, "name": "Rule 3 Start Day", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_3_stop_day": {"address": 8590, "name": "Rule 3 Stop Day", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_3_effective_week": {"address": 8591, "name": "Rule 3 Effective Week", "precision": 0, "index": 0, "type": "select_multi", "options": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]},
    "econ_rule_3_voltage": {"address": 8592, "name": "Rule 3 Voltage", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1, "type": "number", "min": 50.0, "max": 60.0, "step": 1},
    "econ_rule_3_soc": {"address": 8593, "name": "Rule 3 SOC", "unit": "%", "device_class": "battery", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 100, "step": 1},
    "econ_rule_3_power": {"address": 8594, "name": "Rule 3 Power", "unit": "W", "device_class": "power", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 10000, "step": 100},
    
    "econ_rule_4_enable": {"address": 8595, "name": "Economic Mode Rule 4 Enable", "precision": 0, "index": 0,"type": "select", "options": ["Disabled", "Charge", "Discharge"]},
    "econ_rule_4_start_time": {"address": 8596, "name": "Rule 4 Start Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_4_stop_time": {"address": 8597, "name": "Rule 4 Stop Time", "precision": 0, "index": 0, "type": "time"},
    "econ_rule_4_start_day": {"address": 8598, "name": "Rule 4 Start Day", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_4_stop_day": {"address": 8599, "name": "Rule 4 Stop Day", "precision": 0, "index": 0, "type": "date"},
    "econ_rule_4_effective_week": {"address": 8600, "name": "Rule 4 Effective Week", "precision": 0, "index": 0, "type": "select_multi", "options": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]},
    "econ_rule_4_voltage": {"address": 8601, "name": "Rule 4 Voltage", "unit": "V", "device_class": "voltage", "precision": 1, "index": 1, "type": "number", "min": 50.0, "max": 60.0, "step": 1},
    "econ_rule_4_soc": {"address": 8602, "name": "Rule 4 SOC", "unit": "%", "device_class": "battery", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 100, "step": 1},
    "econ_rule_4_power": {"address": 8603, "name": "Rule 4 Power", "unit": "W", "device_class": "power", "precision": 0, "index": 0, "type": "number", "min": 0, "max": 10000, "step": 100},
    
    "display_software_version": {"address": 63548, "name": "Display board software version", "precision": 2, "index": 2},
    "mcu1_software_version": {"address": 63549, "name": "MCU1 software version", "precision": 2, "index": 2},
    "mcu2_software_version": {"address": 63550, "name": "MCU2 software version", "precision": 2, "index": 2},
    "display_hardware_version": {"address": 63551, "name": "Display board hardware version", "precision": 2, "index": 2},
    "control_hardware_version": {"address": 63552, "name": "Control panel hardware version", "precision": 2, "index": 2},
    "power_hardware_version": {"address": 63553, "name": "Power board hardware version", "precision": 2, "index": 2},
}

# 2. Combined entities (post-process after reading)
_COMBINED_REGISTERS = {
    "pv_total_power": {
        "sources": ["pv_input_power", "pv2_input_power", "pv3_input_power"],
        "calc": lambda p1, p2, p3: (p1 or 0) + (p2 or 0) + (p3 or 0),
        "unit": "W",
        "device_class": "power",
        "state_class": "measurement",
        "name": "Total PV Power",
        "precision": 0,
    },
    "ac_active_power": {
        "sources": ["invert_active_power", "invert_active_power_l2", "invert_active_power_l3"],
        "calc": lambda p1, p2, p3: (p1 or 0) + (p2 or 0) + (p3 or 0),
        "unit": "W",
        "device_class": "power",
        "state_class": "measurement",
        "name": "Total AC Active Power",
        "precision": 0,
    },
    "econ_rule_1": {
        "sources": [
            "econ_rule_1_enable",
            "econ_rule_1_start_time",
            "econ_rule_1_stop_time",
            "econ_rule_1_start_day",
            "econ_rule_1_stop_day",
            "econ_rule_1_effective_week",
            "econ_rule_1_voltage",
            "econ_rule_1_soc",
            "econ_rule_1_power",
        ],
        "calc": lambda enable, start_t, stop_t, start_d, stop_d, week, volt, soc, power: {
            "enabled": ["Disabled", "Charge", "Discharge"][enable] if 0 <= enable <= 2 else f"Unknown({enable})",
            "start_time": f"{start_t >> 8:02d}:{start_t & 0xFF:02d}",
            "stop_time": f"{stop_t >> 8:02d}:{stop_t & 0xFF:02d}",
            "start_date": f"{start_d >> 8:02d}-{start_d & 0xFF:02d}",
            "stop_date": f"{stop_d >> 8:02d}-{stop_d & 0xFF:02d}",
            "days": [day for i, day in enumerate(["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]) if (week & (1 << i))],
            "voltage_v": volt if volt else None,
            "soc_value": soc,
            "power_w": power,
        },
        "name": "Economic Mode Rule 1",
    },
    "econ_rule_2": {
        "sources": [
            "econ_rule_2_enable",
            "econ_rule_2_start_time",
            "econ_rule_2_stop_time",
            "econ_rule_2_start_day",
            "econ_rule_2_stop_day",
            "econ_rule_2_effective_week",
            "econ_rule_2_voltage",
            "econ_rule_2_soc",
            "econ_rule_2_power",
        ],
        "calc": lambda enable, start_t, stop_t, start_d, stop_d, week, volt, soc, power: {
            "enabled": ["Disabled", "Charge", "Discharge"][enable] if 0 <= enable <= 2 else f"Unknown({enable})",
            "start_time": f"{start_t >> 8:02d}:{start_t & 0xFF:02d}",
            "stop_time": f"{stop_t >> 8:02d}:{stop_t & 0xFF:02d}",
            "start_date": f"{start_d >> 8:02d}-{start_d & 0xFF:02d}",
            "stop_date": f"{stop_d >> 8:02d}-{stop_d & 0xFF:02d}",
            "days": [day for i, day in enumerate(["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]) if (week & (1 << i))],
            "voltage_v": volt if volt else None,
            "soc_value": soc,
            "power_w": power,
        },
        "name": "Economic Mode Rule 2",
    },
    "econ_rule_3": {
        "sources": [
            "econ_rule_3_enable",
            "econ_rule_3_start_time",
            "econ_rule_3_stop_time",
            "econ_rule_3_start_day",
            "econ_rule_3_stop_day",
            "econ_rule_3_effective_week",
            "econ_rule_3_voltage",
            "econ_rule_3_soc",
            "econ_rule_3_power",
        ],
        "calc": lambda enable, start_t, stop_t, start_d, stop_d, week, volt, soc, power: {
            "enabled": ["Disabled", "Charge", "Discharge"][enable] if 0 <= enable <= 2 else f"Unknown({enable})",
            "start_time": f"{start_t >> 8:02d}:{start_t & 0xFF:02d}",
            "stop_time": f"{stop_t >> 8:02d}:{stop_t & 0xFF:02d}",
            "start_date": f"{start_d >> 8:02d}-{start_d & 0xFF:02d}",
            "stop_date": f"{stop_d >> 8:02d}-{stop_d & 0xFF:02d}",
            "days": [day for i, day in enumerate(["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]) if (week & (1 << i))],
            "voltage_v": volt if volt else None,
            "soc_value": soc,
            "power_w": power,
        },
        "name": "Economic Mode Rule 3",
    },
    "econ_rule_4": {
        "sources": [
            "econ_rule_4_enable",
            "econ_rule_4_start_time",
            "econ_rule_4_stop_time",
            "econ_rule_4_start_day",
            "econ_rule_4_stop_day",
            "econ_rule_4_effective_week",
            "econ_rule_4_voltage",
            "econ_rule_4_soc",
            "econ_rule_4_power",
        ],
        "calc": lambda enable, start_t, stop_t, start_d, stop_d, week, volt, soc, power: {
            "enabled": ["Disabled", "Charge", "Discharge"][enable] if 0 <= enable <= 2 else f"Unknown({enable})",
            "start_time": f"{start_t >> 8:02d}:{start_t & 0xFF:02d}",
            "stop_time": f"{stop_t >> 8:02d}:{stop_t & 0xFF:02d}",
            "start_date": f"{start_d >> 8:02d}-{start_d & 0xFF:02d}",
            "stop_date": f"{stop_d >> 8:02d}-{stop_d & 0xFF:02d}",
            "days": [day for i, day in enumerate(["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]) if (week & (1 << i))],
            "voltage_v": volt if volt else None,
            "soc_value": soc,
            "power_w": power,
        },
        "name": "Economic Mode Rule 4",
    },

    "inverter_time": {
        "sources": [
            "time_year_month",   # 4434
            "time_day_hour",     # 4435
            "time_minute_second",# 4436
            "time_week"          # 4437
        ],
        "calc": lambda year_month, day_hour, min_sec, week: {
            "year": 2000 + (year_month >> 8),  # Assuming 2000-2099
            "month": year_month & 0xFF,
            "day": day_hour >> 8,
            "hour": day_hour & 0xFF,
            "minute": min_sec >> 8,
            "second": min_sec & 0xFF,
            "weekday": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"][week] if 0 <= week <= 6 else f"Unknown({week})",
            "iso_datetime": f"{2000 + (year_month >> 8):04d}-{year_month & 0xFF:02d}-{day_hour >> 8:02d} "
                            f"{day_hour & 0xFF:02d}:{min_sec >> 8:02d}:{min_sec & 0xFF:02d}",
        },
        "name": "Inverter Time",
    },
    "log_time": {
        "sources": [
            "log_time_year_month",
            "log_time_day_hour",
            "log_time_minute_second",
        ],
        "calc": lambda year_month, day_hour, min_sec: {
            "year": 2000 + (year_month >> 8),
            "month": year_month & 0xFF,
            "day": day_hour >> 8,
            "hour": day_hour & 0xFF,
            "minute": min_sec >> 8,
            "second": min_sec & 0xFF,
            "iso_datetime": f"{2000 + (year_month >> 8):04d}-{year_month & 0xFF:02d}-{day_hour >> 8:02d} "
                            f"{day_hour & 0xFF:02d}:{min_sec >> 8:02d}:{min_sec & 0xFF:02d}",
        },
        "name": "Log Entry Time",
    },
}

# In const.py – at the end
REGISTER_SETS = {
    "basic": {
        key: info
        for key, info in _REGISTERS.items()
        if key in {
            "ac_active_power",
            "BMS_Flg",
            "working_mode",
            "sn",
            "warning_state_1",
            "warning_state_2",
            "warning_state_3",
            "operating_mode",
            "fault_code",
            "ac_input_voltage",
            "ac_input_voltage_l2",
            "ac_input_voltage_l3",
            "ac_input_current",
            "ac_input_frequency",
            "ac_input_power",
            "battery_voltage",
            "battery_capacity",
            "battery_power",
            "ac_output_voltage",
            "ac_output_voltage_l2",
            "ac_output_voltage_l3",
            "ac_output_current",
            "ac_output_frequency",
            "ac_output_active_power",
            "ac_input_mid_voltage",
            "ac_input_mid_voltage_l2",
            "ac_input_mid_voltage_l3",
            "load_percentage",
            "pv_input_voltage",
            "pv_input_current",
            "pv_input_power",
            "pv2_input_voltage",
            "pv2_input_current",
            "pv2_input_power",
            "pv3_input_voltage",
            "pv3_input_current",
            "pv3_input_power",
            "total_ac_output_active_power",
            "total_ac_output_apparent_power",
            # Add combined keys if you want them always visible
            "pv_generated_energy_total",
            "load_consumption_energy_total",
            "line_load_consumption_energy_total",
            "battery_charged_energy_total",
            "battery_discharged_energy_total",
            "inverter_time",
            "econ_rule_1",
            "econ_rule_2",
            "econ_rule_3",
            "econ_rule_4",
            "pv_generated_energy_day",
            "pv_generated_energy_month",
            "pv_generated_energy_year",
            "battery_charged_energy_day",
            "battery_discharged_energy_day",
        }
        and "_secondary" not in key  # ← Excludes duplicates!
    },
    "basic_plus": {
        key: info
        for key, info in _REGISTERS.items()
        if (
             key.startswith((
               "ac_input_", 
               "ac_output_", 
               "pv_input_", 
               "battery_", 
               "invert_", 
               "total_ac_"
             ))

           )
        and "_secondary" not in key
        and "_alt" not in key
    },
    "full": _REGISTERS,  # All – including secondary if any (or filter here too if you want)
}

# Optional: Strict full without duplicates
# "full": {k: v for k, v in _REGISTERS.items() if "_secondary" not in k and "_alt" not in k},
# Precision and index based on the "Multiple" column
# 0 = dont process or packed → precision 0, index 0
# -1 = /10 → precision 1, index 1 (or 8 if signed)
# -2 = /100 → precision 2, index 2 (or 3 if signed)
# 5 = faults/warnings/modes/flags index
# 99 = combined/time or other special

_REGISTERS_50 = {
    "time_year_month": {'address': 4357, 'name': 'Time: Year-Month', 'precision': 0, 'index': 99, 'state_class': 'measurement'},
    "time_day_time": {'address': 4358, 'name': 'Time: Day-Time', 'precision': 0, 'index': 99, 'state_class': 'measurement'},
    "time_minutes_seconds": {'address': 4359, 'name': 'Time: minutes-seconds', 'precision': 0, 'index': 99, 'state_class': 'measurement'},
    "time_week": {'address': 4360, 'name': 'Time: Week', 'precision': 0, 'index': 99, 'state_class': 'measurement'},
    "alarm_codes": {'address': 4361, 'name': 'Alarm codes', 'precision': 0, 'index': 5, 'state_class': 'measurement'},
    "fault_codes": {'address': 4362, 'name': 'Fault codes', 'precision': 0, 'index': 5, 'state_class': 'measurement'},
    "pv1_voltage": {'address': 4376, 'name': 'PV1 voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "pv2_voltage": {'address': 4377, 'name': 'PV2 voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "pv3_voltage": {'address': 4378, 'name': 'PV3 voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "pv4_voltage": {'address': 4379, 'name': 'PV4 voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "mppt1_current": {'address': 4380, 'name': 'MPPT1 current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "mppt2_current": {'address': 4381, 'name': 'MPPT2 current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "mppt3_current": {'address': 4382, 'name': 'MPPT3 current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "mppt4_current": {'address': 4383, 'name': 'MPPT4 current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_home_load_power": {'address': 4384, 'name': 'Phase A home load power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_b_home_load_power": {'address': 4385, 'name': 'Phase B home load power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_c_home_load_power": {'address': 4386, 'name': 'Phase C home load power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "pv1_power": {'address': 4392, 'name': 'PV1 power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "pv2_power": {'address': 4393, 'name': 'PV2 power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "pv3_power": {'address': 4394, 'name': 'PV3 power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "pv4_power": {'address': 4395, 'name': 'PV4 power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "bat1_voltage": {'address': 4396, 'name': 'Bat1 voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "bat2_voltage": {'address': 4397, 'name': 'Bat2 voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "bat1_current": {'address': 4400, 'name': 'Bat1 current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "bat1_power": {'address': 4401, 'name': 'Bat1 power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "bat2_current": {'address': 4402, 'name': 'Bat2 current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "bat2_power": {'address': 4403, 'name': 'Bat2 power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "bat1_insulation_resistance": {'address': 4404, 'name': 'Bat1+ insulation resistance', 'precision': 0, 'index': 0, 'unit': 'KΩ', 'state_class': 'measurement'},
    "bat1_insulation_resistance_1": {'address': 4405, 'name': 'Bat1- insulation resistance', 'precision': 0, 'index': 0, 'unit': 'KΩ', 'state_class': 'measurement'},  # Note: key dupes fixed with _1
    "bat2_insulation_resistance": {'address': 4406, 'name': 'Bat2+ insulation resistance', 'precision': 0, 'index': 0, 'unit': 'KΩ', 'state_class': 'measurement'},
    "bat2_insulation_resistance_1": {'address': 4407, 'name': 'Bat2- insulation resistance', 'precision': 0, 'index': 0, 'unit': 'KΩ', 'state_class': 'measurement'},
    "bat1_soc": {'address': 4408, 'name': 'Bat1 SOC', 'precision': 1, 'index': 1, 'device_class': 'battery', 'state_class': 'measurement'},
    "bat1_soh": {'address': 4409, 'name': 'Bat1 SOH', 'precision': 1, 'index': 1, 'device_class': 'battery', 'state_class': 'measurement'},
    "bat1_capacity": {'address': 4410, 'name': 'Bat1 Capacity', 'precision': 0, 'index': 0, 'unit': 'AH', 'state_class': 'measurement'},
    "bat2_soc": {'address': 4411, 'name': 'Bat2 SOC', 'precision': 1, 'index': 1, 'device_class': 'battery', 'state_class': 'measurement'},
    "bat2_soh": {'address': 4412, 'name': 'Bat2 SOH', 'precision': 1, 'index': 1, 'device_class': 'battery', 'state_class': 'measurement'},
    "bat2_capacity": {'address': 4413, 'name': 'Bat2 Capacity', 'precision': 0, 'index': 0, 'unit': 'AH', 'state_class': 'measurement'},
    "bus_voltage": {'address': 4414, 'name': 'Bus voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "bus_voltage_1": {'address': 4415, 'name': 'Bus+ voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "bus_voltage_2": {'address': 4416, 'name': 'Bus- voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "balance_current": {'address': 4417, 'name': 'Balance current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "bus_insulation_resistance": {'address': 4418, 'name': 'Bus+ insulation resistance', 'precision': 0, 'index': 0, 'unit': 'KΩ', 'state_class': 'measurement'},
    "bus_insulation_resistance_1": {'address': 4419, 'name': 'Bus- insulation resistance', 'precision': 0, 'index': 0, 'unit': 'KΩ', 'state_class': 'measurement'},
    "boost_temperature": {'address': 4420, 'name': 'Boost temperature', 'precision': 0, 'index': 0, 'unit': '°C', 'device_class': 'temperature', 'state_class': 'measurement'},
    "inverter_temperature": {'address': 4421, 'name': 'Inverter temperature', 'precision': 0, 'index': 0, 'unit': '°C', 'device_class': 'temperature', 'state_class': 'measurement'},
    "ambient_temperature": {'address': 4422, 'name': 'Ambient temperature', 'precision': 0, 'index': 0, 'unit': '°C', 'device_class': 'temperature', 'state_class': 'measurement'},
    "leakage_current": {'address': 4425, 'name': 'Leakage current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_generator_current": {'address': 4426, 'name': 'Phase A generator current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_b_generator_current": {'address': 4427, 'name': 'Phase B generator current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_c_generator_current": {'address': 4428, 'name': 'Phase C generator current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_generator_voltage": {'address': 4429, 'name': 'Phase A generator voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_b_generator_voltage": {'address': 4430, 'name': 'Phase B generator voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_c_generator_voltage": {'address': 4431, 'name': 'Phase C generator voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_a_grid_voltage": {'address': 4432, 'name': 'Phase A grid voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_b_grid_voltage": {'address': 4433, 'name': 'Phase B grid voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_c_grid_voltage": {'address': 4434, 'name': 'Phase C grid voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_a_inverter_voltage": {'address': 4435, 'name': 'Phase A inverter voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_b_inverter_voltage": {'address': 4436, 'name': 'Phase B inverter voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_c_inverter_voltage": {'address': 4437, 'name': 'Phase C inverter voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_a_load_voltage": {'address': 4438, 'name': 'Phase A load voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_b_load_voltage": {'address': 4439, 'name': 'Phase B load voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_c_load_voltage": {'address': 4440, 'name': 'Phase C load voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_a_ct_current": {'address': 4441, 'name': 'Phase A CT current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_b_ct_current": {'address': 4442, 'name': 'Phase B CT current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_c_ct_current": {'address': 4443, 'name': 'Phase C CT current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_grid_current": {'address': 4444, 'name': 'Phase A grid current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_b_grid_current": {'address': 4445, 'name': 'Phase B grid current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_c_grid_current": {'address': 4446, 'name': 'Phase C grid current', 'precision': 1, 'index': 8, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_inverter_current": {'address': 4447, 'name': 'Phase A inverter current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_b_inverter_current": {'address': 4448, 'name': 'Phase B inverter current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_c_inverter_current": {'address': 4449, 'name': 'Phase C inverter current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_load_current": {'address': 4450, 'name': 'Phase A load current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_b_load_current": {'address': 4451, 'name': 'Phase B load current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_c_load_current": {'address': 4452, 'name': 'Phase C load current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_a_inverter_dc_voltage_value": {'address': 4453, 'name': 'Phase A inverter DC voltage value', 'precision': 0, 'index': 0, 'unit': 'mV', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_b_inverter_dc_voltage_value": {'address': 4454, 'name': 'Phase B inverter DC voltage value', 'precision': 0, 'index': 0, 'unit': 'mV', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_c_inverter_dc_voltage_value": {'address': 4455, 'name': 'Phase C inverter DC voltage value', 'precision': 0, 'index': 0, 'unit': 'mV', 'device_class': 'voltage', 'state_class': 'measurement'},
    "phase_a_inverter_dc_current_value": {'address': 4456, 'name': 'Phase A inverter DC current value', 'precision': 0, 'index': 0, 'unit': 'mA', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_b_inverter_dc_current_value": {'address': 4457, 'name': 'Phase B inverter DC current value', 'precision': 0, 'index': 0, 'unit': 'mA', 'device_class': 'current', 'state_class': 'measurement'},
    "phase_c_inverter_dc_current_value": {'address': 4458, 'name': 'Phase C inverter DC current value', 'precision': 0, 'index': 0, 'unit': 'mA', 'device_class': 'current', 'state_class': 'measurement'},
    "n_n_voltage": {'address': 4459, 'name': 'N-N voltage', 'precision': 1, 'index': 8, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "generator_frequency": {'address': 4460, 'name': 'Generator frequency', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid_frequency": {'address': 4461, 'name': 'Grid frequency', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "inverter_frequency": {'address': 4462, 'name': 'Inverter frequency', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "load_frequency": {'address': 4463, 'name': 'Load frequency', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "phase_a_generator_active_power": {'address': 4464, 'name': 'Phase A generator active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_b_generator_active_power": {'address': 4465, 'name': 'Phase B generator active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_c_generator_active_power": {'address': 4466, 'name': 'Phase C generator active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_a_grid_active_power": {'address': 4467, 'name': 'Phase A grid active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_b_grid_active_power": {'address': 4468, 'name': 'Phase B grid active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_c_grid_active_power": {'address': 4469, 'name': 'Phase C grid active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_a_inverter_active_power": {'address': 4470, 'name': 'Phase A inverter active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_b_inverter_active_power": {'address': 4471, 'name': 'Phase B inverter active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_c_inverter_active_power": {'address': 4472, 'name': 'Phase C inverter active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_a_load_active_power": {'address': 4473, 'name': 'Phase A load active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_b_load_active_power": {'address': 4474, 'name': 'Phase B load active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_c_load_active_power": {'address': 4475, 'name': 'Phase C load active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_a_load_apparent_power": {'address': 4476, 'name': 'Phase A load apparent power', 'precision': 1, 'index': 8, 'unit': 'kVA', 'device_class': 'apparent_power', 'state_class': 'measurement'},  # Custom: apparent_power
    "phase_b_load_apparent_power": {'address': 4477, 'name': 'Phase B load apparent power', 'precision': 1, 'index': 8, 'unit': 'kVA', 'device_class': 'apparent_power', 'state_class': 'measurement'},
    "phase_c_load_apparent_power": {'address': 4478, 'name': 'Phase C load apparent power', 'precision': 1, 'index': 8, 'unit': 'kVA', 'device_class': 'apparent_power', 'state_class': 'measurement'},
    "phase_a_load_percentage": {'address': 4479, 'name': 'Phase A load percentage', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "phase_b_load_percentage": {'address': 4480, 'name': 'Phase B load percentage', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "phase_c_load_percentage": {'address': 4481, 'name': 'Phase C load percentage', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "phase_a_ct_active_power": {'address': 4482, 'name': 'Phase A CT active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_b_ct_active_power": {'address': 4483, 'name': 'Phase B CT active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_c_ct_active_power": {'address': 4484, 'name': 'Phase C CT active power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "phase_a_grid_power_factor_0_01": {'address': 4485, 'name': 'Phase A Grid Power Factor (0.01)', 'precision': 2, 'index': 3, 'device_class': 'power_factor', 'state_class': 'measurement'},  # Custom: power_factor
    "phase_b_grid_power_factor_0_01": {'address': 4486, 'name': 'Phase B Grid Power Factor (0.01)', 'precision': 2, 'index': 3, 'device_class': 'power_factor', 'state_class': 'measurement'},
    "phase_c_grid_power_factor_0_01": {'address': 4487, 'name': 'Phase C Grid Power Factor (0.01)', 'precision': 2, 'index': 3, 'device_class': 'power_factor', 'state_class': 'measurement'},
    "phase_a_inverter_power_factor_0_01": {'address': 4488, 'name': 'Phase A inverter power factor (0.01)', 'precision': 2, 'index': 3, 'device_class': 'power_factor', 'state_class': 'measurement'},
    "phase_b_inverter_power_factor_0_01": {'address': 4489, 'name': 'Phase B inverter power factor (0.01)', 'precision': 2, 'index': 3, 'device_class': 'power_factor', 'state_class': 'measurement'},
    "phase_c_inverter_power_factor_0_01": {'address': 4490, 'name': 'Phase C inverter power factor (0.01)', 'precision': 2, 'index': 3, 'device_class': 'power_factor', 'state_class': 'measurement'},
    "microinverter_total_energy_high_0_1kwh": {'address': 4492, 'name': 'Microinverter Total Energy High （0.1KWh）', 'precision': 1, 'index': 8, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "microinverter_total_energy_low_0_1kwh": {'address': 4493, 'name': 'Microinverter Total Energy Low （0.1KWh）', 'precision': 1, 'index': 8, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "generator_start_signal": {'address': 4497, 'name': 'Generator start signal', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},  # From old pattern
    "total_generator_power": {'address': 4498, 'name': 'Total generator power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "total_load_power": {'address': 4499, 'name': 'Total load power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "total_grid_power": {'address': 4500, 'name': 'Total grid power', 'precision': 1, 'index': 8, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "pv1_day_energy_0_1kwh": {'address': 4529, 'name': 'PV1 Day Energy（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv1_month_energy_high_0_1kwh": {'address': 4530, 'name': 'PV1 Month Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv1_month_energy_low_0_1kwh": {'address': 4531, 'name': 'PV1 Month Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv1_year_energy_high_0_1kwh": {'address': 4532, 'name': 'PV1 Year Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv1_year_energy_low_0_1kwh": {'address': 4533, 'name': 'PV1 Year Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv2_day_energy_0_1kwh": {'address': 4534, 'name': 'PV2 Day Energy（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv2_month_energy_high_0_1kwh": {'address': 4535, 'name': 'PV2 Month Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv2_month_energy_low_0_1kwh": {'address': 4536, 'name': 'PV2 Month Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv2_year_energy_high_0_1kwh": {'address': 4537, 'name': 'PV2 Year Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv2_year_energy_low_0_1kwh": {'address': 4538, 'name': 'PV2 Year Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv3_day_energy_0_1kwh": {'address': 4539, 'name': 'PV3 Day Energy（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv3_month_energy_high_0_1kwh": {'address': 4540, 'name': 'PV3 Month Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv3_month_energy_low_0_1kwh": {'address': 4541, 'name': 'PV3 Month Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv3_year_energy_high_0_1kwh": {'address': 4542, 'name': 'PV3 Year Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv3_year_energy_low_0_1kwh": {'address': 4543, 'name': 'PV3 Year Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv4_day_energy_0_1kwh": {'address': 4544, 'name': 'PV4 Day Energy（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv4_month_energy_high_0_1kwh": {'address': 4545, 'name': 'PV4 Month Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv4_month_energy_low_0_1kwh": {'address': 4546, 'name': 'PV4 Month Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv4_year_energy_high_0_1kwh": {'address': 4547, 'name': 'PV4 Year Energy High（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv4_year_energy_low_0_1kwh": {'address': 4548, 'name': 'PV4 Year Energy Low（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "pv_total_energy_high": {'address': 4549, 'name': 'PV Total Energy High', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "pv_total_energy_low": {'address': 4550, 'name': 'PV Total Energy Low', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat1_day_charge_energy_0_1kwh": {'address': 4551, 'name': 'Bat1 Day Charge Energy（0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat1_month_charge_energy_high_0_1kwh": {'address': 4552, 'name': 'Bat1 Month Charge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat1_month_charge_energy_low_0_1kwh": {'address': 4553, 'name': 'Bat1 Month Charge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat1_year_charge_energy_high_0_1kwh": {'address': 4554, 'name': 'Bat1 Year Charge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat1_year_charge_energy_low_0_1kwh": {'address': 4555, 'name': 'Bat1 Year Charge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat1_day_discharge_energy_0_1kwh": {'address': 4556, 'name': 'Bat1 Day Discharge Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat1_month_discharge_energy_high_0_1kwh": {'address': 4557, 'name': 'Bat1 Month Discharge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat1_month_discharge_energy_low_0_1kwh": {'address': 4558, 'name': 'Bat1 Month Discharge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat1_year_discharge_energy_high_0_1kwh": {'address': 4559, 'name': 'Bat1 Year Discharge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat1_year_discharge_energy_low_0_1kwh": {'address': 4560, 'name': 'Bat1 Year Discharge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat2_day_charge_energy_0_1kwh": {'address': 4561, 'name': 'BAT2 Day Charge Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat2_month_charge_energy_high_0_1kwh": {'address': 4562, 'name': 'BAT2 Month Charge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat2_month_charge_energy_low_0_1kwh": {'address': 4563, 'name': 'BAT2 Month Charge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat2_year_charge_energy_high_0_1kwh": {'address': 4564, 'name': 'BAT2 Year Charge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat2_year_charge_energy_low_0_1kwh": {'address': 4565, 'name': 'BAT2 Year Charge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat2_day_discharge_energy_0_1kwh": {'address': 4566, 'name': 'BAT2 Day Discharge Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat2_month_discharge_energy_high_0_1kwh": {'address': 4567, 'name': 'BAT2 Month Discharge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat2_month_discharge_energy_low_0_1kwh": {'address': 4568, 'name': 'BAT2 Month Discharge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "bat2_year_discharge_energy_high_0_1kwh": {'address': 4569, 'name': 'BAT2 Year Discharge Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "bat2_year_discharge_energy_low_0_1kwh": {'address': 4570, 'name': 'BAT2 Year Discharge Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "grid_day_cost_energy_0_1kwh": {'address': 4571, 'name': 'Grid Day Cost Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "grid_month_cost_energy_high_0_1kwh": {'address': 4572, 'name': 'Grid Month Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "grid_month_cost_energy_low_0_1kwh": {'address': 4573, 'name': 'Grid Month Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "grid_year_cost_energy_high_0_1kwh": {'address': 4574, 'name': 'Grid Year Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "grid_year_cost_energy_low_0_1kwh": {'address': 4575, 'name': 'Grid Year Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "grid_day_feed_energy_0_1kwh": {'address': 4576, 'name': 'Grid Day Feed Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "grid_month_feed_energy_high_0_1kwh": {'address': 4577, 'name': 'Grid Month Feed Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "grid_month_feed_energy_low_0_1kwh": {'address': 4578, 'name': 'Grid Month Feed Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "grid_year_feed_energy_high_0_1kwh": {'address': 4579, 'name': 'Grid Year Feed Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "grid_year_feed_energy_low_0_1kwh": {'address': 4580, 'name': 'Grid Year Feed Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "load_day_cost_energy_0_1kwh": {'address': 4581, 'name': 'Load Day Cost Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "load_month_cost_energy_high_0_1kwh": {'address': 4582, 'name': 'Load Month Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "load_month_cost_energy_low_0_1kwh": {'address': 4583, 'name': 'Load Month Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "load_year_cost_energy_high_0_1kwh": {'address': 4584, 'name': 'Load Year Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "load_year_cost_energy_low_0_1kwh": {'address': 4585, 'name': 'Load Year Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "generator_day_cost_energy_0_1kwh": {'address': 4586, 'name': 'Generator Day Cost Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "generator_month_cost_energy_high_0_1kwh": {'address': 4587, 'name': 'Generator Month Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "generator_month_cost_energy_low_0_1kwh": {'address': 4588, 'name': 'Generator Month Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "generator_year_cost_energy_high_0_1kwh": {'address': 4589, 'name': 'Generator Year Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "generator_year_cost_energy_low_0_1kwh": {'address': 4590, 'name': 'Generator Year Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "microinverter_day_cost_energy_0_1kwh": {'address': 4591, 'name': 'Microinverter Day Cost Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "microinverter_month_cost_energy_high_0_1kwh": {'address': 4592, 'name': 'Microinverter Month Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "microinverter_month_cost_energy_low_0_1kwh": {'address': 4593, 'name': 'Microinverter Month Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "microinverter_year_cost_energy_high_0_1kwh": {'address': 4594, 'name': 'Microinverter Year Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "microinverter_year_cost_energy_low_0_1kwh": {'address': 4595, 'name': 'Microinverter Year Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "homeload_day_cost_energy_0_1kwh": {'address': 4596, 'name': 'Homeload Day Cost Energy （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "homeload_month_cost_energy_high_0_1kwh": {'address': 4597, 'name': 'Homeload Month Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "homeload_month_cost_energy_low_0_1kwh": {'address': 4598, 'name': 'Homeload Month Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "homeload_year_cost_energy_high_0_1kwh": {'address': 4599, 'name': 'Homeload Year Cost Energy High （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing', 'size': 2, 'endian': 'big'},
    "homeload_year_cost_energy_low_0_1kwh": {'address': 4600, 'name': 'Homeload Year Cost Energy Low （0.1KWh）', 'precision': 1, 'index': 1, 'unit': 'kWh', 'device_class': 'energy', 'state_class': 'total_increasing'},
    "battery_1_max_charge_current": {'address': 8471, 'name': 'Battery 1 MAX charge current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "battery_1_max_discharge_current": {'address': 8472, 'name': 'Battery 1 MAX discharge current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "grid_start_signal": {'address': 8477, 'name': 'Grid start signal', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "generator_cooldown_time": {'address': 8478, 'name': 'Generator cooldown time', 'precision': 1, 'index': 1, 'unit': 'hours', 'state_class': 'measurement'},
    "generator_forced_to_run": {'address': 8479, 'name': 'Generator forced to run', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "soc_of_the_grid_auto_start_charge": {'address': 8480, 'name': 'SOC of the Grid Auto Start Charge', 'precision': 0, 'index': 0, 'device_class': 'battery', 'state_class': 'measurement'},
    "soc_of_the_grid_exit_charge": {'address': 8481, 'name': 'SOC of the Grid Exit Charge', 'precision': 0, 'index': 0, 'device_class': 'battery', 'state_class': 'measurement'},
    "soc_of_the_gen_auto_start_charge": {'address': 8482, 'name': 'SOC of the GEN Auto Start Charge', 'precision': 0, 'index': 0, 'device_class': 'battery', 'state_class': 'measurement'},
    "soc_of_the_gen_exit_charge": {'address': 8483, 'name': 'SOC of the GEN Exit Charge', 'precision': 0, 'index': 0, 'device_class': 'battery', 'state_class': 'measurement'},
    "grid_charge_current": {'address': 8484, 'name': 'Grid Charge Current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "gen_charge_current": {'address': 8485, 'name': 'GEN Charge Current', 'precision': 1, 'index': 1, 'unit': 'A', 'device_class': 'current', 'state_class': 'measurement'},
    "gen_start_signal": {'address': 8486, 'name': 'GEN Start Signal', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "grid_charge_enable": {'address': 8487, 'name': 'Grid Charge Enable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "gen_charge_enable": {'address': 8488, 'name': 'GEN Charge Enable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "gen_max_run_time": {'address': 8489, 'name': 'GEN Max Run Time', 'precision': 1, 'index': 1, 'unit': 'hours', 'state_class': 'measurement'},
    "voltage_of_the_grid_auto_start_charge": {'address': 8490, 'name': 'Voltage of the Grid Auto Start Charge', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "voltage_of_the_grid_exit_charge": {'address': 8491, 'name': 'Voltage of the Grid Exit Charge', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "voltage_of_the_gen_auto_start_charge": {'address': 8492, 'name': 'Voltage of the GEN Auto Start Charge', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "voltage_of_the_gen_exit_charge": {'address': 8493, 'name': 'Voltage of the GEN Exit Charge', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "battery_float_charge_voltage": {'address': 8500, 'name': 'Battery float charge voltage', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "voltage_of_the_battery_restart": {'address': 8503, 'name': 'Voltage of the Battery Restart', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "voltage_of_the_battery_low_alarm": {'address': 8504, 'name': 'Voltage of the Battery Low Alarm', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "voltage_of_the_battery_shutdown": {'address': 8505, 'name': 'Voltage of the Battery Shutdown', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "soc_of_the_battery_restart": {'address': 8506, 'name': 'SOC of the Battery Restart', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "soc_of_the_battery_low_alarm": {'address': 8507, 'name': 'SOC of the Battery Low Alarm', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "soc_of_the_battery_shutdown": {'address': 8508, 'name': 'SOC of the Battery Shutdown', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "system_mode": {'address': 8516, 'name': 'System Mode', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Selling Mode', 'Zero Export To Load', 'Zero Export To CT']},
    "zero_export_to_load_sell_enable": {'address': 8517, 'name': 'Zero Export To Load Sell Enable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "zero_export_to_ct_sell_enable": {'address': 8518, 'name': 'Zero Export To CT Sell Enable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "max_export_power_to_grid": {'address': 8519, 'name': 'Max-Export power to grid', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "grid_peak_shaving_enable": {'address': 8520, 'name': 'Grid Peak Shaving Enable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "grid_peak_shaving_power": {'address': 8521, 'name': 'Grid Peak Shaving Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "zero_export_power": {'address': 8522, 'name': 'Zero-export Power', 'precision': 0, 'index': 0, 'unit': 'W', 'device_class': 'power', 'state_class': 'measurement'},
    "zero_export_mode_selection": {'address': 8523, 'name': 'Zero-export mode selection', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['CT', 'Meter']},
    "energy_priority": {'address': 8525, 'name': 'Energy priority', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Bat First', 'Load First']},
    "grid_port_balance_enable": {'address': 8542, 'name': 'Grid Port Balance Enable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "back_up_delay": {'address': 8544, 'name': 'Back Up delay', 'precision': 0, 'index': 0, 'unit': 'ms', 'state_class': 'measurement'},
    "load_relay_break": {'address': 8548, 'name': 'Load Relay Break', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "back_up_delay_time": {'address': 8549, 'name': 'Back Up Delay time', 'precision': 0, 'index': 0, 'unit': 's', 'state_class': 'measurement'},
    "gridnormalconnecthighvolt": {'address': 8624, 'name': 'GridNormalConnectHighVolt', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gridnormalconnectlowvolt": {'address': 8625, 'name': 'GridNormalConnectLowVolt', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gridnormalconnecthighfreq": {'address': 8626, 'name': 'GridNormalConnectHighFreq', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gridnormalconnectlowfreq": {'address': 8627, 'name': 'GridNormalConnectLowFreq', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gridrecconnecthighvolt": {'address': 8628, 'name': 'GridRecConnectHighVolt', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gridrecconnectlowvolt": {'address': 8629, 'name': 'GridRecConnectLowVolt', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gridrecconnecthighfreq": {'address': 8630, 'name': 'GridRecConnectHighFreq', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gridrecconnectlowfreq": {'address': 8631, 'name': 'GridRecConnectLowFreq', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid1ovvalue": {'address': 8666, 'name': 'Grid1OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid1ovtime": {'address': 8667, 'name': 'Grid1OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid2ovvalue": {'address': 8668, 'name': 'Grid2OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid2ovtime": {'address': 8669, 'name': 'Grid2OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid3ovvalue": {'address': 8670, 'name': 'Grid3OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid3ovtime": {'address': 8671, 'name': 'Grid3OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid4ovvalue": {'address': 8672, 'name': 'Grid4OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid4ovtime": {'address': 8673, 'name': 'Grid4OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid5ovvalue": {'address': 8674, 'name': 'Grid5OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid5ovtime": {'address': 8675, 'name': 'Grid5OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid1uvvalue": {'address': 8676, 'name': 'Grid1UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid1uvtime": {'address': 8677, 'name': 'Grid1UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid2uvvalue": {'address': 8678, 'name': 'Grid2UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid2uvtime": {'address': 8679, 'name': 'Grid2UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid3uvvalue": {'address': 8680, 'name': 'Grid3UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid3uvtime": {'address': 8681, 'name': 'Grid3UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid4uvvalue": {'address': 8682, 'name': 'Grid4UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid4uvtime": {'address': 8683, 'name': 'Grid4UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid5uvvalue": {'address': 8684, 'name': 'Grid5UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "grid5uvtime": {'address': 8685, 'name': 'Grid5UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gridvunbalanceprotectvalue": {'address': 8686, 'name': 'GridVUnbalanceProtectValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gridvunbalanceprotecttime": {'address': 8687, 'name': 'GridVUnbalanceProtectTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid1ofvalue": {'address': 8688, 'name': 'Grid1OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid1oftime": {'address': 8689, 'name': 'Grid1OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid2ofvalue": {'address': 8690, 'name': 'Grid2OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid2oftime": {'address': 8691, 'name': 'Grid2OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid3ofvalue": {'address': 8692, 'name': 'Grid3OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid3oftime": {'address': 8693, 'name': 'Grid3OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid4ofvalue": {'address': 8694, 'name': 'Grid4OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid4oftime": {'address': 8695, 'name': 'Grid4OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid5ofvalue": {'address': 8696, 'name': 'Grid5OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid5oftime": {'address': 8697, 'name': 'Grid5OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid1ufvalue": {'address': 8698, 'name': 'Grid1UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid1uftime": {'address': 8699, 'name': 'Grid1UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid2ufvalue": {'address': 8700, 'name': 'Grid2UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid2uftime": {'address': 8701, 'name': 'Grid2UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid3ufvalue": {'address': 8702, 'name': 'Grid3UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid3uftime": {'address': 8703, 'name': 'Grid3UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid4ufvalue": {'address': 8704, 'name': 'Grid4UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid4uftime": {'address': 8705, 'name': 'Grid4UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "grid5ufvalue": {'address': 8706, 'name': 'Grid5UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "grid5uftime": {'address': 8707, 'name': 'Grid5UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "10minovpenable": {'address': 8708, 'name': '10minOVPEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "10minovpvalue": {'address': 8709, 'name': '10minOVPValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "10minovptime": {'address': 8710, 'name': '10minOVPTime', 'precision': 0, 'index': 0, 'unit': 's', 'state_class': 'measurement'},
    "eco_timeofuse": {'address': 8711, 'name': 'ECO_TimeOfUse', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco_effectiveweek": {'address': 8712, 'name': 'ECO_EffectiveWeek', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco1_gridchargeenable": {'address': 8713, 'name': 'ECO1_GridChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco1_genchargeenable": {'address': 8714, 'name': 'ECO1_GenChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco1_starttime": {'address': 8715, 'name': 'ECO1_StartTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco1_stoptime": {'address': 8716, 'name': 'ECO1_StopTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco1_volt": {'address': 8717, 'name': 'ECO1_Volt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "eco1_soc": {'address': 8718, 'name': 'ECO1_SOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "eco1_power": {'address': 8719, 'name': 'ECO1_Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "eco2_gridchargeenable": {'address': 8720, 'name': 'ECO2_GridChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco2_genchargeenable": {'address': 8721, 'name': 'ECO2_GenChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco2_starttime": {'address': 8722, 'name': 'ECO2_StartTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco2_stoptime": {'address': 8723, 'name': 'ECO2_StopTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco2_volt": {'address': 8724, 'name': 'ECO2_Volt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "eco2_soc": {'address': 8725, 'name': 'ECO2_SOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "eco2_power": {'address': 8726, 'name': 'ECO2_Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "eco3_gridchargeenable": {'address': 8727, 'name': 'ECO3_GridChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco3_genchargeenable": {'address': 8728, 'name': 'ECO3_GenChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco3_starttime": {'address': 8729, 'name': 'ECO3_StartTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco3_stoptime": {'address': 8730, 'name': 'ECO3_StopTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco3_volt": {'address': 8731, 'name': 'ECO3_Volt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "eco3_soc": {'address': 8732, 'name': 'ECO3_SOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "eco3_power": {'address': 8733, 'name': 'ECO3_Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "eco4_gridchargeenable": {'address': 8734, 'name': 'ECO4_GridChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco4_genchargeenable": {'address': 8735, 'name': 'ECO4_GenChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco4_starttime": {'address': 8736, 'name': 'ECO4_StartTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco4_stoptime": {'address': 8737, 'name': 'ECO4_StopTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco4_volt": {'address': 8738, 'name': 'ECO4_Volt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "eco4_soc": {'address': 8739, 'name': 'ECO4_SOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "eco4_power": {'address': 8740, 'name': 'ECO4_Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "eco5_gridchargeenable": {'address': 8741, 'name': 'ECO5_GridChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco5_genchargeenable": {'address': 8742, 'name': 'ECO5_GenChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco5_starttime": {'address': 8743, 'name': 'ECO5_StartTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco5_stoptime": {'address': 8744, 'name': 'ECO5_StopTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco5_volt": {'address': 8745, 'name': 'ECO5_Volt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "eco5_soc": {'address': 8746, 'name': 'ECO5_SOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "eco5_power": {'address': 8747, 'name': 'ECO5_Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "eco6_gridchargeenable": {'address': 8748, 'name': 'ECO6_GridChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco6_genchargeenable": {'address': 8749, 'name': 'ECO6_GenChargeEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "eco6_starttime": {'address': 8750, 'name': 'ECO6_StartTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco6_stoptime": {'address': 8751, 'name': 'ECO6_StopTime', 'precision': 0, 'index': 99, 'type': 'time', 'state_class': 'measurement'},
    "eco6_volt": {'address': 8752, 'name': 'ECO6_Volt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "eco6_soc": {'address': 8753, 'name': 'ECO6_SOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "eco6_power": {'address': 8754, 'name': 'ECO6_Power', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "genmode": {'address': 8759, 'name': 'GenMode', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Generator', 'Smart Load', 'Micro Inv']},
    "geninputratepower": {'address': 8760, 'name': 'GenInputRatePower', 'precision': 1, 'index': 1, 'unit': 'kW', 'device_class': 'power', 'state_class': 'measurement'},
    "genpowerpeakshaving": {'address': 8761, 'name': 'GenPowerPeakShaving', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "genconnecttogridportenable": {'address': 8762, 'name': 'GenConnectToGridPortEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "smartloadcloseenable": {'address': 8763, 'name': 'SmartLoadCloseEnable', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "smartload_closebatvolt": {'address': 8764, 'name': 'SmartLoad_CloseBatVolt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "smartload_openbatvolt": {'address': 8765, 'name': 'SmartLoad_OpenBatVolt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "smartload_closesoc": {'address': 8766, 'name': 'SmartLoad_CloseSOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "smartload_opensoc": {'address': 8767, 'name': 'SmartLoad_OpenSOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "ac_couple_frz_high": {'address': 8768, 'name': 'AC_Couple_Frz_High', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "ml_export_to_grid_cutoff": {'address': 8769, 'name': 'Ml_export_to_Grid_cutoff', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "ac_couple_onside": {'address': 8770, 'name': 'AC_Couple_OnSide', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Grid', 'Load']},
    "micro_closebatvolt": {'address': 8771, 'name': 'Micro_CloseBatVolt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "micro_openbatvolt": {'address': 8772, 'name': 'Micro_OpenBatVolt', 'precision': 1, 'index': 1, 'unit': 'V', 'device_class': 'voltage', 'state_class': 'measurement'},
    "micro_closesoc": {'address': 8773, 'name': 'Micro_CloseSOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "micro_opensoc": {'address': 8774, 'name': 'Micro_OpenSOC', 'precision': 0, 'index': 0, 'unit': '%', 'device_class': 'battery', 'state_class': 'measurement'},
    "smartload_closeminpvpower": {'address': 8775, 'name': 'SmartLoad_CloseMinPvPower', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "smartload_offgridimmediatelyoff": {'address': 8776, 'name': 'SmartLoad_offGridimmediatelyOff', 'precision': 0, 'index': 0, 'state_class': 'measurement', 'type': 'select', 'options': ['Disabled', 'Enabled']},
    "gen1ovvalue": {'address': 8778, 'name': 'Gen1OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gen1ovtime": {'address': 8779, 'name': 'Gen1OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen2ovvalue": {'address': 8780, 'name': 'Gen2OVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gen2ovtime": {'address': 8781, 'name': 'Gen2OVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen1uvvalue": {'address': 8782, 'name': 'Gen1UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gen1uvtime": {'address': 8783, 'name': 'Gen1UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen2uvvalue": {'address': 8784, 'name': 'Gen2UVValue', 'precision': 0, 'index': 0, 'unit': '%', 'state_class': 'measurement'},
    "gen2uvtime": {'address': 8785, 'name': 'Gen2UVTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen1ofvalue": {'address': 8786, 'name': 'Gen1OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gen1oftime": {'address': 8787, 'name': 'Gen1OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen2ofvalue": {'address': 8788, 'name': 'Gen2OFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gen2oftime": {'address': 8789, 'name': 'Gen2OFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen1ufvalue": {'address': 8790, 'name': 'Gen1UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gen1uftime": {'address': 8791, 'name': 'Gen1UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
    "gen2ufvalue": {'address': 8792, 'name': 'Gen2UFValue', 'precision': 2, 'index': 2, 'unit': 'Hz', 'device_class': 'frequency', 'state_class': 'measurement'},
    "gen2uftime": {'address': 8793, 'name': 'Gen2UFTime', 'precision': 2, 'index': 2, 'unit': 's', 'state_class': 'measurement'},
}

# Combined registers (post-process)
_COMBINED_REGISTERS_50 = {
    "inverter_time": {
        "sources": ["time_year_month", "time_day_time", "time_minutes_seconds", "time_week"],
        "calc": lambda ym, dh, ms, w: {
            "year": 2000 + (ym >> 8),
            "month": ym & 0xFF,
            "day": dh >> 8,
            "hour": dh & 0xFF,
            "minute": ms >> 8,
            "second": ms & 0xFF,
            "weekday": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"][w] if 0 <= w <= 6 else f"Unknown({w})",
            "iso_datetime": f"{2000 + (ym >> 8):04d}-{ym & 0xFF:02d}-{dh >> 8:02d} "
                            f"{dh & 0xFF:02d}:{ms >> 8:02d}:{ms & 0xFF:02d}",
        },
        "name": "Inverter Time",
    },
    "pv_total_power": {
        "sources": ["pv1_power", "pv2_power", "pv3_power", "pv4_power"],
        "calc": lambda p1, p2, p3, p4: (p1 or 0) + (p2 or 0) + (p3 or 0) + (p4 or 0),
        "unit": "kW",
        "device_class": "power",
        "state_class": "measurement",
        "name": "Total PV Power",
        "precision": 1,
    },
    "battery_total_power": {
        "sources": ["bat1_power", "bat2_power"],
        "calc": lambda p1, p2: (p1 or 0) + (p2 or 0),
        "unit": "kW",
        "device_class": "power",
        "state_class": "measurement",
        "name": "Total Battery Power",
        "precision": 1,
    },
    # ECO rules (6, each with grid/gen enable, start/stop time, volt, soc, power)
    "eco_rule_1": {
        "sources": [
            "eco1_gridchargeenable",
            "eco1_genchargeenable",
            "eco1_starttime",
            "eco1_stoptime",
            "eco1_volt",
            "eco1_soc",
            "eco1_power",
        ],
        "calc": lambda grid_en, gen_en, start_t, stop_t, volt, soc, power: {
            "grid_charge": "Enabled" if grid_en else "Disabled",
            "gen_charge": "Enabled" if gen_en else "Disabled",
            "start_time": f"{start_t >> 8:02d}:{start_t & 0xFF:02d}",
            "stop_time": f"{stop_t >> 8:02d}:{stop_t & 0xFF:02d}",
            "voltage_v": volt,
            "soc_value": soc,
            "power_kw": power,
        },
        "name": "ECO Mode Rule 1",
    },
    # ... Repeat for eco_rule_2 to eco_rule_6 with appropriate sources
    # (offsets: ECO2 at +7, ECO3 +14, etc. — adjust addresses accordingly)
}
# Model-specific data (extend for new models)
def build_groups(registers):
    sorted_regs = sorted(registers.items(), key=lambda x: x[1]["address"])
    groups = []
    current = None
    current_size = None

    for key, info in sorted_regs:
        addr = info["address"]
        size = info.get("size", 1)

        if current is None:
            current = {"start": addr, "count": size, "keys": [key]}
            current_size = size
        else:
            expected_next = current["start"] + current["count"]
            if addr == expected_next and size == current_size and current["count"] + size <= 120:
                current["count"] += size
                current["keys"].append(key)
            else:
                groups.append(current)
                current = {"start": addr, "count": size, "keys": [key]}
                current_size = size

    if current:
        groups.append(current)
    return groups

_REGISTER_GROUPS = build_groups(_REGISTERS)  # auto-generated

MODEL_DATA = {
    INVERTER_MODEL_IVGM: {
        "registers": _REGISTERS,
        "groups": _REGISTER_GROUPS,
        "combined": _COMBINED_REGISTERS,
        "sets": REGISTER_SETS,
    },
}
